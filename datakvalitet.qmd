---
title: "Fia datakvalitet"
subtitle: Statistikk som viser datakvalitet i Fia - Fagsystemet for oppfølging av IA-oppdraget i NAV.
title-block-banner: true
title-block-banner-color: white
date: now
date-format: "DD.MM.YYYY HH:mm:ss z"
published-title: "Oppdatert"
author: Team Pia
author-title: "Eier"
execute:
    echo: false
    warning: false
format:
    html:
        toc: true
        toc-title: Indeks
        page-layout: full
        embed-resources: true
jupyter: python3
---

Ansvarlig team er [Team Pia](https://teamkatalog.nav.no/team/b347ac99-c382-4e5a-a1dd-532e91110e2a).
Kontakt oss på [slack](https://nav-it.slack.com/archives/C02DL347ZT2) eller på e-post `pia` ved `nav.no`.

<span style="color:red;">
NB! Dette er ikke offisiell statistikk og må ikke deles utenfor NAV.
</span>

```{python}
import os

from code.datahandler import (
    load_data,
    load_data_deduplicate,
    split_data_statistikk,
    preprocess_data_status,
    preprocess_data_leveranse,
)
from code.plots_datakvalitet import (
    saker_per_status_over_tid,
    dager_mellom_statusendringer,
)


PROJECT = os.environ['GCP_PROJECT']
DATASET = os.environ['DATASET']
data_statistikk = load_data_deduplicate(PROJECT, DATASET, "ia-sak-statistikk-v1")
data_leveranse = load_data(PROJECT, DATASET, "ia-sak-leveranse-v1")

data_status, data_eierskap = split_data_statistikk(data_statistikk)
data_status = preprocess_data_status(data_status)
data_leveranse = preprocess_data_leveranse(data_leveranse)
```


## Antall saker per status over tid
```{python}
saker_per_status_over_tid(data_status)
```


## Dager mellom statusendringer
```{python}
status_endringer = (
    data_status[(data_status.forrige_status != "NY")]
    .groupby(["forrige_status", "status"])
    .size()
    .index
)
for forrige_status, status in status_endringer:
    fig = dager_mellom_statusendringer(data_status, forrige_status, status)
    fig.show()
```
